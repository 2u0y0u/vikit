<div class="navbar navbar-default navbar-static-top" role="navigation">
      <button  id="start" style="display: none;">start</button>
        <div class="container-fluid">
          <ul class="nav navbar-nav navbar-right">
            <li>
            <!-- <a href="javascript:void(0)" id="start" class="start_state" onclick="start()">
            
            <span class="fre_log">start</span>
            
              </a> -->
              <div class="switch " data-on="danger" data-off="success" style="margin-top: 15px;margin-right: 20px;">
                <input type="checkbox" name="my-checkbox" id="start" checked>
              </div>
            </li>
            
            <li>
              <a href="javascript:void(0)" onclick="platform()">平台管理</a>
            </li>
          </ul>
        </div>
        
      </div>
<script type="text/javascript">
$("[name='my-checkbox']").bootstrapSwitch({
        onText:"start",  
        offText:"stop",  
        onColor:"success",  
        offColor:"warning",  
        size:"small",  
        onSwitchChange:function(event,state){  
            if(state==true){  
                $.ajax(
            {
                url: "{{ url_for('shutdown') }}",
                async:false,
                success: function (result) {

                    if(result == 'closed'){
                        alert('stop success');
                        $.cookie('state','offline');
                    }
                },
                error:function (e) {
                    alert('ajax start request failed');
                    
                }

            }
        )
            }else{  
                start();
            }  
        }
});
$(document).ready(function(){
        if($.cookie('state')==null){
            $.cookie('state','offline');
        }

        //use to handle refresh
        if($.cookie('state')=='online'){
          $("[name='my-checkbox']").click();
            
        }
     });
function start(){
      $.ajax(
            {
                url: "{{ url_for('start') }}",
                async:false,
                success: function (result) {
                    if(result == 'success'){
                      if($.cookie('state')=='offline'){
                        alert('start success');
                        $.cookie('state','online');
                        setTimeout("ajax_get_mods()", 1000);  
                      }
                    }
                },
                error:function (e) {
                    alert('ajax start request failed');
                }

            }
        )
  }


function platform(){
  var protocol= window.location.protocol;
  var hostname=window.location.hostname;
  var url=protocol+'//'+hostname+':8081';
  window.location.href=url;
}
</script>